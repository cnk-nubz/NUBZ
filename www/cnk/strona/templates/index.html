<!DOCTYPE html>
{% load compress %}
{% load staticfiles %}
{% load jsvar %}
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" href="{% static "favicon.ico" %}">

  <title>Tajny Projekt NUBZ</title>

  <script src="{% static "js/jquery.min.js" %}"></script>
  <script src="{% static "js/d3.v3.min.js" %}"></script>
  <script src="{% static "js/bootstrap.min.js" %}"></script>
  <script src="{% static "js/bootstrap-dialog.js" %}"></script>
  <script src="{% static "js/ie10-viewport-bug-workaround.js" %}"></script>
  <script src="{% static "js/csrf.js" %}"></script>

  <!-- LEAFLET -->
  <script src="{% static "js/leaflet-src.js" %}"></script>
  <script src="{% static "js/easy-button.js" %}"></script>

  <!-- Leaflet label -->
  <script src="{% static "js/Label.js" %}"></script>
  <script src="{% static "js/BaseMarkerMethods.js" %}"></script>
  <script src="{% static "js/Marker.Label.js" %}"></script>
  <script src="{% static "js/Path.Label.js" %}"></script>
  <script src="{% static "js/Map.Label.js" %}"></script>
  <script src="{% static "js/FeatureGroup.Label.js" %}"></script>

  <!-- Leaflet drag -->
  <script src="{% static "js/SVG.js" %}"></script>
  <script src="{% static "js/Path.Transform.js" %}"></script>
  <script src="{% static "js/Path.Drag.js" %}"></script>

  <!-- Leaflet edit -->
  <script src="{% static "js/Leaflet.draw.js" %}"></script>
  <script src="{% static "js/edit/handler/Edit.Poly.js" %}"></script>
  <script src="{% static "js/edit/handler/Edit.SimpleShape.js" %}"></script>
  <script src="{% static "js/edit/handler/Edit.Rectangle.js" %}"></script>

  <!-- CSS -->
  <link href="{% static "css/bootstrap.min.css" %}" rel="stylesheet" />
  <link href="{% static "css/base.css" %}" rel="stylesheet" />
  <link href="{% static "css/leaflet.css" %}" rel="stylesheet" />
  <link href="{% static "css/easy-button.css" %}" rel="stylesheet" />
  <link href="{% static "css/leaflet.label.css" %}" rel="stylesheet" />
  <link href="{% static "css/font-awesome.min.css" %}" rel="stylesheet" />
  <link href="{% static "css/bootstrap-dialog.css" %}" rel="stylesheet" />
  {% compress js %}
  <script type="text/coffeescript">
    root = exports ? this
    root.csrf_form = "{% csrf_token %}"
  </script>
  {% endcompress %}
</head>
<body>
  {% compress js %}
  <script src="{% static "coffee/MapDataHandler.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/View.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/MainPage.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/Navbar.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/Canvas.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/MutableCanvas.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/JustMapPage.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/EditMapPage.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script type="text/coffeescript">
    document.detached = {}
    root = exports ? this
    floorUrl = [
      "{{urlFloor0|escape|safe}}"
      "{{urlFloor1|escape|safe}}"
    ]
    activeFloor = +"{{acitveFloor}}"
    exhibits = jQuery.map({{exhibits | jsvar}}, (val) -> [val])
    floorTilesInfo = jQuery.map({{floorTilesInfo | jsvar}}, (val) -> [val])
    (floorTilesInfo[i] = jQuery.map(floorTilesInfo[i], (val) -> [val])) for i in [0..1]
    mapData = new MapDataHandler(activeFloor, floorUrl, exhibits, floorTilesInfo)
    jQuery(document).ready( ->
      page = new root.MainPage "body"
      page.refresh()
    )
  </script>
  {% endcompress %}
</body>
</html>
