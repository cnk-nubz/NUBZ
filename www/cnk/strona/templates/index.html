{% extends "base.html" %}
{% load compress %}
{% load staticfiles %}
{% load jsvar %}
{% block content %}
  {% compress js %}
  <script src="{% static "coffee/MapDataHandler.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/ExhibitDialog.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/Appearance.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/View.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/MainPage.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/Navbar.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/Canvas.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/MutableCanvas.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/JustMapPage.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/EditMapPage.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script src="{% static "coffee/ExhibitPanel.class.coffee"%}" type="text/coffeescript"></script>
  {% endcompress %}
  {% compress js %}
  <script type="text/coffeescript">
    document.detached = {}
    root = exports ? this
    floorUrl = [
      "{{urlFloor0|escape|safe}}"
      "{{urlFloor1|escape|safe}}"
    ]
    activeFloor = +"{{acitveFloor}}"
    exhibits = jQuery.map({{exhibits | jsvar}}, (val) -> [val])
    floorTilesInfo = jQuery.map({{floorTilesInfo | jsvar}}, (val) -> [val])
    (floorTilesInfo[i] = jQuery.map(floorTilesInfo[i], (val) -> [val])) for i in [0..1]
    mapData = new MapDataHandler(activeFloor, floorUrl, exhibits, floorTilesInfo)
    jQuery(document).ready( ->
      page = new root.MainPage "body"
      page.refresh()
    )
  </script>
  {% endcompress %}
{% endblock %}
